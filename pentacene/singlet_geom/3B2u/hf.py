"""
HF Calculation for pentacene at singlet geometry with 1Ag symmetry.
"""

import numpy
import scipy.linalg

from pyscf import gto
from pyscf import scf
from pyscf import mcscf
from pyscf import tools
from pyscf import ao2mo
from pyscf import symm
from pyscf.shciscf import shci
from pyscf import lib
from pyscf.tools.dump_mat import dump_mo
from pyscf.tools import molden

mol = gto.Mole()
mol.build(
    verbose=5,
    atom=[
        ["C", (6.1034736501, 0.7143520224, 0.0000000000)],
        ["C", (6.1034736501, -0.7143520224, 0.0000000000)],
        ["C", (4.9241464460, 1.4087655595, 0.0000000000)],
        ["C", (4.9241464460, -1.4087655595, 0.0000000000)],
        ["C", (3.6699600616, 0.7221273949, 0.0000000000)],
        ["C", (3.6699600616, -0.7221273949, 0.0000000000)],
        ["C", (2.4552073049, 1.4103452597, 0.0000000000)],
        ["C", (2.4552073049, -1.4103452597, 0.0000000000)],
        ["C", (1.2224160233, 0.7264645751, 0.0000000000)],
        ["C", (1.2224160233, -0.7264645751, 0.0000000000)],
        ["C", (0.0000000000, 1.4097960386, 0.0000000000)],
        ["C", (0.0000000000, -1.4097960386, 0.0000000000)],
        ["C", (-1.2224160233, 0.7264645751, 0.0000000000)],
        ["C", (-1.2224160233, -0.7264645751, 0.0000000000)],
        ["C", (-2.4552073049, 1.4103452597, 0.0000000000)],
        ["C", (-2.4552073049, -1.4103452597, 0.0000000000)],
        ["C", (-3.6699600616, 0.7221273949, 0.0000000000)],
        ["C", (-3.6699600616, -0.7221273949, 0.0000000000)],
        ["C", (-4.9241464460, 1.4087655595, 0.0000000000)],
        ["C", (-4.9241464460, -1.4087655595, 0.0000000000)],
        ["C", (-6.1034736501, 0.7143520224, 0.0000000000)],
        ["C", (-6.1034736501, -0.7143520224, 0.0000000000)],
        ["H", (7.0439413690, 1.2458592335, 0.0000000000)],
        ["H", (7.0439413690, -1.2458592335, 0.0000000000)],
        ["H", (4.9223841486, 2.4905939907, 0.0000000000)],
        ["H", (4.9223841486, -2.4905939907, 0.0000000000)],
        ["H", (2.4572055256, 2.4937949835, 0.0000000000)],
        ["H", (2.4572055256, -2.4937949835, 0.0000000000)],
        ["H", (0.0000000000, 2.4935420070, 0.0000000000)],
        ["H", (0.0000000000, -2.4935420070, 0.0000000000)],
        ["H", (-2.4572055256, 2.4937949835, 0.0000000000)],
        ["H", (-2.4572055256, -2.4937949835, 0.0000000000)],
        ["H", (-4.9223841486, 2.4905939907, 0.0000000000)],
        ["H", (-4.9223841486, -2.4905939907, 0.0000000000)],
        ["H", (-7.0439413690, 1.2458592335, 0.0000000000)],
        ["H", (-7.0439413690, -1.2458592335, 0.0000000000)],
    ],
    basis="ccpvdz",
    symmetry=1,
    spin=0,
    output="_hf.out",
)

mf = scf.RHF(mol).set(chkfile="5cene_HF.chk")
mf.level_shift_factor = 0.4
mf.max_cycle = 100
mf.conv_tol = 1e-9
mf.scf()

fname = "5cene"
with open(fname + "_cmo.molden", "w") as thefile:
    molden.header(mol, thefile)
    molden.orbital_coeff(mol, thefile, mf.mo_coeff)
